var MatrixEditor=function(){function n(n,t,i){this.parentElement=n,this.serverProxy=t,this.deleteBtn=i,this.matrixParent=document.getElementById(n),this.collapsed=!1,this.topLeftCellId="topLeftCell"}return n.prototype.init=function(n){var t,i,r;for(this.matrix=n,this.remove(),this.tableBuilder=new TableBuilder(n.dimension,this.parentElement,this),t=0;t<n.dimension;t++)for(i=0;i<n.dimension;i++)r=n.elements==null?0:parseFloat(n.elements[t][i]),this.tableBuilder.addCell(r)},n.prototype.remove=function(){for(var n=this.matrixParent.childNodes;n.length;)this.matrixParent.removeChild(n[0])},n.prototype.collapseHandler=function(){var u,f,t,n,r,i;if(this.collapsed){for(t=this.matrix.elements.length,n=0;n<t;n++)for(r=0;r<t;r++)i=this.matrix.elements[n][r],i=typeof i=="string"?parseFloat(i).toFixed(4):i.toFixed(4),document.getElementById(this.getCellId(n+1,r+1)).innerText=i;this.collapsed=!1}else{for(u=document.getElementsByTagName("td"),t=u.length,n=0;n<t;n++)f=u[n],f.innerText="";this.collapsed=!0}},n.prototype.loadFileHandler=function(n,t){var i=this,u="Loaded from file ("+t.name+")",f=function(n){var t=i.getDataFromFileString(n);i.init({elements:t,dimension:t.length,description:u})},r=new FileReader;r.readAsText(t,"UTF-8"),r.onload=function(n){var t=n.target.result;f(t)}},n.prototype.getDataFromFileString=function(n){for(var u=n.split(/\r?\n+/),f=[],e=u.length,r,t,i=0;i<e;i++){for(r=u[i].split(" "),t=0;t<e;t++)r[t]=parseFloat(r[t]);f.push(r)}return f},n.prototype.getCellId=function(n,t){return"id"+n+"_"+t},n.prototype.clearValues=function(){for(var i=this.matrix.elements.length,t,n=0;n<i;n++)for(t=0;t<i;t++)this.matrix.elements[n][t]=0;this.init(this.matrix)},n.prototype.update=function(n){this.matrix.description=n.description;var i=typeof this.matrix.dimension=="string"?parseInt(this.matrix.dimension.toString()):this.matrix.dimension,t=typeof n.dimension=="string"?parseInt(n.dimension.toString()):n.dimension;t!=this.matrix.dimension&&(t<this.matrix.dimension?this.tableBuilder.reduceDimension(t):this.tableBuilder.increaseDimension(t))},n.prototype.loadMatrixFromSite=function(n){this.matrix=n,this.remove(),this.tableBuilder=new TableBuilder(n.dimension,this.parentElement,this);var t=this,i=function(r){for(var f,e,u=0;u<r.length;u++)t.tableBuilder.addCell(r[u].value,!0);f=t.tableBuilder.lastAddedCell,e=(f.row-1)*n.dimension+f.col,e<n.dimension*n.dimension?t.serverProxy.getElements(n.matrixId,e,i):$(t.deleteBtn).show()};this.serverProxy.getElements(n.matrixId,0,i)},n}()